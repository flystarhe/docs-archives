title: 最大似然估计
date: 2016-07-10
tags: [NLP,最大似然估计]
---
它最早由高斯提出。后来为费歇在1912年的文章中重新提出，并且证明了这个方法的一些性质。极大似然估计这一名称也是费歇给的。最大似然估计提供了一种给定观察数据来评估模型参数的方法，即“模型已定，参数未知”。

<!--more-->
## 基本思想
最大似然估计法的思想很简单：在已经得到试验结果的情况下，我们应该寻找使这个结果出现的可能性最大的那个$\theta$作为真$\theta$的估计。

## 离散型总体
设X为离散型随机变量，其概率分布的形式为$P\{X=x\} = p(x,\theta_1,\theta_2,..,\theta_k)$，则样本$X_1,X_2,..,X_n$的概率分布为：

\begin{align}
P\{X_1=x_1,..,X_n=x_n\} = \prod_{i=1}^{n} p(x_i,\theta_1,\theta_2,..,\theta_k)
\end{align}

在$\theta_1,..,\theta_k$固定时，上式表示$X_1,..,X_n$取值$x_1,..,x_n$的概率。当$x_1,..,x_n$固定时，它是$\theta_1,..,\theta_k$的函数，把它标记为$L(\theta_1,..,\theta_k)$并称为似然函数。

似然函数$L(\theta_1,..,\theta_k)$的值的大小意味着该样本值出现的可能性的大小。既然已经得到了样本值$x_1,..,x_n$，那它出现的概率就应该最大。因为我们选择使$L(\theta_1,..,\theta_k)$达到最大值的那个$\theta$作为真$\theta$的估计。

## 连续型总体
设X为连续型随机变量，其概率密度函数为$f(x,\theta_1,..,\theta_k)$，则$X_1,..,X_n$为从该总体抽取的样本。因为$X_1,..,X_n$独立同分布，于是样本的联合概率密度函数为：

\begin{align}
L(x_1,..,x_n,\theta_1,..,\theta_k) = \prod_{i=1}^{n} f(x_i,\theta_1,..,\theta_k)
\end{align}

当$x_1,..,x_n$固定时，它是$\theta_1,..,\theta_k$的函数，把它标记为$L(\theta_1,..,\theta_k)$并称为似然函数。类似，我们选择使$L(\theta_1,..,\theta_k)$达到最大值的那个$\theta$作为真$\theta$的估计。

## 求解似然估计
求$\theta$的极大似然估计，即求$L(\theta)$的最大值点。由于对数函数单调递增，所以$\ln \, L(\theta) = \sum_{i=1}^{n} \, \ln \, f(x_i,\theta_1,..,\theta_k)$与$L(\theta)$有相同的最大值点。对$\ln \, L(\theta)$关于$\theta_1,..,\theta_k$求导数，并命其等于零，得到方程组：

\begin{align}
\frac{\partial \ln L(\theta)}{\partial \theta_i} = 0 , \qquad i=1,..,k
\end{align}

解这个方程组，又能验证它是一个极大值点，也就找到了真$\theta$的估计。

## 一个简单直观的例子
举个别人博客中的例子，假如有一个罐子，里面有黑白两种颜色的球，数目多少不知，两种颜色的比例也不知。我们想知道罐中白球和黑球的比例，但我们不能把罐中的球全部拿出来数。现在我们每次随意从已经摇匀的罐中拿一个球出来，记录球的颜色，然后把拿出来的球再放回罐中。这个过程可以重复，我们可以用记录的球的颜色来估计罐中黑白球的比例。假如在前面的一百次重复记录中，有七十次是白球，请问罐中白球所占的比例最有可能是多少？很多人马上就有答案了：70%。而其后的理论支撑是什么呢？

我们假设罐中白球的比例是p，那么黑球的比例就是`1-p`。因为每抽一个球出来，在记录颜色之后，我们把抽出的球放回了罐中并摇匀，所以每次抽出来的球的颜色服从独立同分布。这里我们把一次抽出来球的颜色称为一次抽样。题目中在一百次抽样中，七十次是白球的概率是`P(Data|M)`，这里Data是所有的数据，M是所给出的模型，表示每次抽出来的球是白色的概率为p。如果第一抽样的结果记为x1，第二抽样的结果记为x2..，那么`Data = (x1,x2,..,x100)`。这样：

\begin{align}
P(Data|M) &= P(x_1,x_2,..,x_100|M) \\
          &= P(x_1|M)P(x_2|M)..P(x_100|M) \\
          &= p^{70}(1-p)^{30}
\end{align}

那么p在取什么值的时候，`P(Data|M)`的值最大呢？将$p^{70}(1-p)^{30}$对p求导，并令其等于零，解方程可得`p=0.7`，和常识中按抽样中的比例的计算结果一样。

## 参考资料：
- [最大似然估计法](http://blog.sciencenet.cn/blog-491809-400893.html)
- [你真的理解最大似然估计？](http://www.tanghuangwhu.com/archives/43)